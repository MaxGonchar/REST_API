# Response Components in REST API

## Introduction

A REST API response is the server's answer to a client's request. Like requests, responses consist of multiple components that work together to communicate the outcome, provide data, and guide client behavior.

**Key principle:** Response components must work in harmony to provide a complete, self-descriptive, and unambiguous answer to the request.

---

## Anatomy of a Complete Response

### Complete Response Example

```http
HTTP/1.1 201 Created
Date: Mon, 13 Jan 2026 10:00:00 GMT
Server: nginx/1.21.0
Content-Type: application/json; charset=utf-8
Content-Length: 289
Location: /api/v1/users/42
ETag: "user-v1-abc123"
Cache-Control: private, no-cache
X-Request-ID: req-abc-123-xyz
X-RateLimit-Limit: 1000
X-RateLimit-Remaining: 999
X-RateLimit-Reset: 1673611200
Access-Control-Allow-Origin: https://app.example.com
Vary: Accept, Accept-Encoding

{
  "id": 42,
  "name": "John Doe",
  "email": "john@example.com",
  "role": "user",
  "createdAt": "2026-01-13T10:00:00Z",
  "links": {
    "self": "/api/v1/users/42",
    "orders": "/api/v1/users/42/orders",
    "profile": "/api/v1/users/42/profile"
  }
}
```

### Breaking Down the Components

```
┌─────────────────────────────────────────────────────────┐
│ STATUS LINE                                             │
│ HTTP/1.1 201 Created                                   │
│ ↑        ↑   ↑                                         │
│ │        │   └─ Reason phrase (human-readable)        │
│ │        └─ Status code (machine-readable)            │
│ └─ Protocol version                                    │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ RESPONSE HEADERS                                        │
│ Content-Type: application/json ← Body format           │
│ Content-Length: 289 ← Body size                        │
│ Location: /api/v1/users/42 ← Created resource         │
│ ETag: "user-v1-abc123" ← Resource version             │
│ Cache-Control: private ← Caching instructions         │
│ X-RateLimit-Remaining: 999 ← Rate limit status        │
│ Date: Mon, 13 Jan 2026... ← Response timestamp        │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ RESPONSE BODY                                           │
│ {                                                       │
│   "id": 42,                                            │
│   "name": "John Doe",                                  │
│   ...                                                   │
│   "links": {...} ← Hypermedia links                    │
│ }                                                       │
└─────────────────────────────────────────────────────────┘
```

---

## Component Interactions

### 1. Status Code + Body: Communicating the Outcome

The status code and body work together to tell the complete story.

#### Success Responses (2xx)

**200 OK - Successful retrieval/update with data:**
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "id": 42,
  "name": "John Doe"
}
```

**201 Created - Resource created with data:**
```http
HTTP/1.1 201 Created
Location: /users/42
Content-Type: application/json

{
  "id": 42,
  "name": "John Doe",
  "createdAt": "2026-01-13T10:00:00Z"
}
```

**204 No Content - Success without body:**
```http
HTTP/1.1 204 No Content
```
*No body sent - useful for DELETE or updates where client already has the data*

#### Error Responses (4xx, 5xx)

**400 Bad Request - Validation errors with details:**
```http
HTTP/1.1 400 Bad Request
Content-Type: application/json

{
  "error": "Bad Request",
  "message": "Validation failed",
  "details": [
    {
      "field": "email",
      "message": "Invalid email format",
      "value": "not-an-email"
    }
  ]
}
```

**404 Not Found - Resource doesn't exist:**
```http
HTTP/1.1 404 Not Found
Content-Type: application/json

{
  "error": "Not Found",
  "message": "User with id 42 not found",
  "requestedResource": "/users/42"
}
```

**Key insight:** Status code tells WHAT happened, body explains WHY and HOW to fix it.

---

### 2. Status Code + Location: Indicating Resource Creation

For 201 Created responses, Location header tells where the new resource lives.

#### Request-Response Cycle

```http
# REQUEST
POST /users
Content-Type: application/json

{
  "name": "John Doe",
  "email": "john@example.com"
}

# RESPONSE
HTTP/1.1 201 Created
Location: /users/42
Content-Type: application/json

{
  "id": 42,
  "name": "John Doe",
  "email": "john@example.com",
  "createdAt": "2026-01-13T10:00:00Z"
}
```

**Components work together:**
- **201 Created:** Success, new resource created
- **Location header:** Here's where to find it
- **Body:** Here's the complete created resource

#### Client can now:
```http
# Follow the Location to GET the resource
GET /users/42
```

---

### 3. Status Code + Cache Headers: Optimizing Performance

Status codes 200, 304, and cache headers work together.

#### Fresh Data (200 OK)

```http
# REQUEST
GET /articles/42

# RESPONSE
HTTP/1.1 200 OK
Content-Type: application/json
ETag: "article-v5"
Cache-Control: public, max-age=3600
Last-Modified: Mon, 13 Jan 2026 09:00:00 GMT

{
  "id": 42,
  "title": "Article Title",
  "content": "..."
}
```

#### Cached Data Still Valid (304 Not Modified)

```http
# REQUEST (client sends cached ETag)
GET /articles/42
If-None-Match: "article-v5"

# RESPONSE (no body - use cache!)
HTTP/1.1 304 Not Modified
ETag: "article-v5"
Cache-Control: public, max-age=3600
```

**Components work together:**
- **304 status:** Your cached version is still valid
- **ETag match:** Here's the version confirmation
- **No body:** Save bandwidth, use your cache
- **Cache-Control:** Still valid for 3600 seconds

---

### 4. Content-Type + Body: Format Agreement

Content-Type tells the client how to parse the body.

#### JSON Response

```http
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8

{
  "id": 42,
  "name": "John Doe"
}
```

#### XML Response

```http
HTTP/1.1 200 OK
Content-Type: application/xml; charset=utf-8

<?xml version="1.0" encoding="UTF-8"?>
<user>
  <id>42</id>
  <name>John Doe</name>
</user>
```

#### CSV Response

```http
HTTP/1.1 200 OK
Content-Type: text/csv; charset=utf-8
Content-Disposition: attachment; filename="users.csv"

id,name,email
42,John Doe,john@example.com
43,Jane Smith,jane@example.com
```

#### Binary Response (Image)

```http
HTTP/1.1 200 OK
Content-Type: image/jpeg
Content-Length: 45678
Cache-Control: public, max-age=86400

[binary image data]
```

**Key insight:** Content-Type and body must match. Client uses Content-Type to choose the right parser.

---

### 5. Status Code + Rate Limit Headers: Controlling Usage

Rate limit headers provide context for both success and failure.

#### Successful Request Within Limits

```http
HTTP/1.1 200 OK
Content-Type: application/json
X-RateLimit-Limit: 1000
X-RateLimit-Remaining: 850
X-RateLimit-Reset: 1673611200

{
  "data": "..."
}
```

**Client knows:**
- Request succeeded
- 850 requests remaining
- Limit resets at timestamp 1673611200

#### Rate Limit Exceeded

```http
HTTP/1.1 429 Too Many Requests
Content-Type: application/json
Retry-After: 3600
X-RateLimit-Limit: 1000
X-RateLimit-Remaining: 0
X-RateLimit-Reset: 1673611200

{
  "error": "Rate Limit Exceeded",
  "message": "Too many requests. Try again later.",
  "retryAfter": 3600,
  "resetAt": "2026-01-13T11:00:00Z"
}
```

**Components work together:**
- **429 status:** Too many requests
- **Retry-After:** Wait this many seconds
- **Rate limit headers:** Current limit status
- **Body:** Human-readable explanation with retry time

---

### 6. Status Code + WWW-Authenticate: Authentication Challenges

For 401 responses, WWW-Authenticate tells the client how to authenticate.

#### Missing Authentication

```http
# REQUEST (no auth header)
GET /protected/resource

# RESPONSE
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer realm="api", charset="UTF-8"
Content-Type: application/json

{
  "error": "Unauthorized",
  "message": "Authentication required",
  "authenticationScheme": "Bearer"
}
```

#### Invalid Token

```http
# REQUEST (invalid token)
GET /protected/resource
Authorization: Bearer invalid-token

# RESPONSE
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer realm="api", error="invalid_token", error_description="Token expired"
Content-Type: application/json

{
  "error": "Unauthorized",
  "message": "Token expired",
  "code": "TOKEN_EXPIRED"
}
```

**Components work together:**
- **401 status:** Authentication problem
- **WWW-Authenticate:** Use Bearer tokens
- **Body:** Specific error details

---

### 7. Multiple Headers Working Together

Real-world responses combine many headers for complete communication.

```http
HTTP/1.1 200 OK
Date: Mon, 13 Jan 2026 10:00:00 GMT
Server: nginx/1.21.0
Content-Type: application/json; charset=utf-8
Content-Length: 156
Content-Encoding: gzip
ETag: "user-v3"
Cache-Control: private, max-age=300, must-revalidate
Last-Modified: Mon, 13 Jan 2026 09:55:00 GMT
X-Request-ID: req-abc-123
X-RateLimit-Limit: 1000
X-RateLimit-Remaining: 850
X-RateLimit-Reset: 1673611200
Access-Control-Allow-Origin: https://app.example.com
Access-Control-Allow-Credentials: true
Vary: Accept, Accept-Encoding, Authorization
Link: </users?page=2>; rel="next", </users?page=1>; rel="prev"

[compressed JSON data]
```

**Each header serves a purpose:**
- **Content-Type, Content-Length, Content-Encoding:** Body format
- **ETag, Last-Modified, Cache-Control:** Caching
- **X-RateLimit-*:** Rate limiting
- **Access-Control-*:** CORS
- **Vary:** Cache key variations
- **Link:** Pagination links
- **X-Request-ID:** Request tracking

---

## Response Patterns

### Pattern 1: Simple Successful Retrieval

```http
# REQUEST
GET /users/42
Accept: application/json

# RESPONSE
HTTP/1.1 200 OK
Content-Type: application/json
ETag: "user-v1"
Cache-Control: private, max-age=300

{
  "id": 42,
  "name": "John Doe",
  "email": "john@example.com"
}
```

**Components:**
- **200:** Success
- **Content-Type:** JSON format
- **ETag:** Version for caching
- **Cache-Control:** Can cache for 5 minutes
- **Body:** The requested data

---

### Pattern 2: Resource Creation with Location

```http
# REQUEST
POST /users
Content-Type: application/json

{
  "name": "John Doe",
  "email": "john@example.com"
}

# RESPONSE
HTTP/1.1 201 Created
Location: /users/42
Content-Type: application/json
ETag: "user-v1"

{
  "id": 42,
  "name": "John Doe",
  "email": "john@example.com",
  "createdAt": "2026-01-13T10:00:00Z",
  "links": {
    "self": "/users/42"
  }
}
```

**Components:**
- **201:** Resource created
- **Location:** Where to find it
- **ETag:** Initial version
- **Body:** Created resource with generated fields (id, timestamp)

---

### Pattern 3: Validation Error Response

```http
# REQUEST
POST /users
Content-Type: application/json

{
  "name": "",
  "email": "not-an-email"
}

# RESPONSE
HTTP/1.1 422 Unprocessable Entity
Content-Type: application/json
X-Request-ID: req-xyz-789

{
  "error": "Validation Failed",
  "message": "The request contains invalid data",
  "details": [
    {
      "field": "name",
      "message": "Name cannot be empty",
      "code": "REQUIRED_FIELD"
    },
    {
      "field": "email",
      "message": "Invalid email format",
      "code": "INVALID_FORMAT",
      "value": "not-an-email"
    }
  ]
}
```

**Components:**
- **422:** Validation failed
- **Content-Type:** Error details in JSON
- **X-Request-ID:** For tracking/debugging
- **Body:** Specific validation errors per field

---

### Pattern 4: Not Modified (Cached)

```http
# REQUEST
GET /users/42
If-None-Match: "user-v5"

# RESPONSE
HTTP/1.1 304 Not Modified
ETag: "user-v5"
Cache-Control: private, max-age=300
Last-Modified: Mon, 13 Jan 2026 09:00:00 GMT
```

**Components:**
- **304:** Not modified, use cache
- **ETag:** Version confirmation
- **Cache-Control:** Still valid
- **No body:** Bandwidth saved

---

### Pattern 5: Successful Deletion

```http
# REQUEST
DELETE /users/42
Authorization: Bearer token123

# RESPONSE (Option 1: No Content)
HTTP/1.1 204 No Content
X-Request-ID: req-delete-123
```

```http
# RESPONSE (Option 2: With confirmation body)
HTTP/1.1 200 OK
Content-Type: application/json
X-Request-ID: req-delete-123

{
  "message": "User successfully deleted",
  "deletedId": 42,
  "deletedAt": "2026-01-13T10:00:00Z"
}
```

**Components:**
- **204 or 200:** Success
- **204:** No body (efficient)
- **200:** Body with confirmation details
- **X-Request-ID:** Request tracking

---

### Pattern 6: Partial Update Response

```http
# REQUEST
PATCH /users/42
Content-Type: application/json
If-Match: "user-v5"

{
  "bio": "Updated biography"
}

# RESPONSE
HTTP/1.1 200 OK
Content-Type: application/json
ETag: "user-v6"
Last-Modified: Mon, 13 Jan 2026 10:05:00 GMT

{
  "id": 42,
  "name": "John Doe",
  "email": "john@example.com",
  "bio": "Updated biography",
  "updatedAt": "2026-01-13T10:05:00Z"
}
```

**Components:**
- **200:** Success
- **ETag:** New version after update
- **Last-Modified:** Update timestamp
- **Body:** Complete updated resource

---

### Pattern 7: Pagination Response

```http
# REQUEST
GET /users?page=2&limit=20

# RESPONSE
HTTP/1.1 200 OK
Content-Type: application/json
X-Total-Count: 150
X-Page: 2
X-Per-Page: 20
X-Total-Pages: 8
Link: </users?page=3&limit=20>; rel="next",
      </users?page=1&limit=20>; rel="prev",
      </users?page=1&limit=20>; rel="first",
      </users?page=8&limit=20>; rel="last"

{
  "data": [
    {"id": 21, "name": "User 21"},
    {"id": 22, "name": "User 22"},
    ...
  ],
  "pagination": {
    "page": 2,
    "limit": 20,
    "total": 150,
    "pages": 8,
    "hasNext": true,
    "hasPrev": true
  },
  "links": {
    "next": "/users?page=3&limit=20",
    "prev": "/users?page=1&limit=20",
    "first": "/users?page=1&limit=20",
    "last": "/users?page=8&limit=20"
  }
}
```

**Components:**
- **200:** Success
- **X-Total-Count, X-Page, etc.:** Pagination metadata in headers
- **Link header:** Standard pagination links (RFC 5988)
- **Body:** Data + pagination info + links

---

### Pattern 8: Async Operation Accepted

```http
# REQUEST
POST /reports/generate
Content-Type: application/json

{
  "type": "annual",
  "year": 2025
}

# RESPONSE
HTTP/1.1 202 Accepted
Location: /reports/jobs/job-abc-123
Content-Type: application/json
Retry-After: 60

{
  "jobId": "job-abc-123",
  "status": "pending",
  "message": "Report generation started",
  "estimatedCompletionTime": "2026-01-13T10:05:00Z",
  "links": {
    "status": "/reports/jobs/job-abc-123",
    "cancel": "/reports/jobs/job-abc-123/cancel"
  }
}
```

**Components:**
- **202:** Accepted for processing (async)
- **Location:** Where to check status
- **Retry-After:** When to check again
- **Body:** Job details and status links

---

### Pattern 9: Redirect Response

```http
# REQUEST
GET /users/john-doe

# RESPONSE (Permanent redirect)
HTTP/1.1 301 Moved Permanently
Location: /users/42
Content-Type: application/json

{
  "message": "User endpoint moved",
  "newLocation": "/users/42"
}
```

```http
# RESPONSE (Temporary redirect)
HTTP/1.1 307 Temporary Redirect
Location: /users/42
Retry-After: 3600

{
  "message": "Temporarily redirected during maintenance",
  "temporaryLocation": "/users/42"
}
```

**Components:**
- **301/307:** Redirect status
- **Location:** Where to go
- **Body:** Optional explanation

---

### Pattern 10: Conflict Response

```http
# REQUEST
PUT /documents/42
If-Match: "doc-v5"
Content-Type: application/json

{"content": "Updated"}

# RESPONSE
HTTP/1.1 409 Conflict
Content-Type: application/json
ETag: "doc-v7"

{
  "error": "Conflict",
  "message": "Document was modified by another user",
  "currentVersion": "doc-v7",
  "requestedVersion": "doc-v5",
  "lastModifiedBy": "user@example.com",
  "lastModifiedAt": "2026-01-13T10:00:00Z",
  "links": {
    "current": "/documents/42"
  }
}
```

**Components:**
- **409:** Conflict detected
- **ETag:** Current version
- **Body:** Conflict details and who/when modified

---

### Pattern 11: Server Error Response

```http
# REQUEST
GET /users/42

# RESPONSE
HTTP/1.1 500 Internal Server Error
Content-Type: application/json
X-Request-ID: req-error-123
Retry-After: 300

{
  "error": "Internal Server Error",
  "message": "An unexpected error occurred",
  "requestId": "req-error-123",
  "timestamp": "2026-01-13T10:00:00Z",
  "supportContact": "support@example.com"
}
```

**Components:**
- **500:** Server error
- **X-Request-ID:** For support/debugging
- **Retry-After:** When to retry
- **Body:** Error details (sanitized, no stack trace)

---

## Response Headers Deep Dive

### Standard Response Headers

#### Content Headers

```http
Content-Type: application/json; charset=utf-8
Content-Length: 156
Content-Encoding: gzip
Content-Language: en-US
Content-Location: /users/42
```

**Purpose:** Describe the response body

#### Cache Headers

```http
Cache-Control: public, max-age=3600, must-revalidate
ETag: "user-v5"
Last-Modified: Mon, 13 Jan 2026 09:00:00 GMT
Expires: Mon, 13 Jan 2026 11:00:00 GMT
Vary: Accept, Accept-Encoding
```

**Purpose:** Control caching behavior

#### Location Headers

```http
Location: /users/42
Content-Location: /users/42/profile
```

**Purpose:** Indicate resource location

#### Security Headers

```http
Access-Control-Allow-Origin: https://app.example.com
Access-Control-Allow-Credentials: true
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
X-XSS-Protection: 1; mode=block
```

**Purpose:** Security policies

#### Custom API Headers

```http
X-Request-ID: req-abc-123
X-RateLimit-Limit: 1000
X-RateLimit-Remaining: 850
X-RateLimit-Reset: 1673611200
X-API-Version: 1.0
X-Response-Time: 45ms
X-Total-Count: 150
```

**Purpose:** API-specific metadata

---

## Error Response Patterns

### Consistent Error Structure

```json
{
  "error": "Error Type",
  "message": "Human-readable description",
  "code": "MACHINE_READABLE_CODE",
  "details": [],
  "requestId": "req-abc-123",
  "timestamp": "2026-01-13T10:00:00Z",
  "documentation": "https://api.example.com/docs/errors/ERROR_CODE"
}
```

### Error Response Examples

#### 400 Bad Request

```http
HTTP/1.1 400 Bad Request
Content-Type: application/json

{
  "error": "Bad Request",
  "message": "Invalid request format",
  "code": "INVALID_JSON",
  "details": {
    "line": 5,
    "column": 10,
    "parseError": "Unexpected token }"
  }
}
```

#### 401 Unauthorized

```http
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer realm="api"
Content-Type: application/json

{
  "error": "Unauthorized",
  "message": "Token expired",
  "code": "TOKEN_EXPIRED",
  "expiredAt": "2026-01-13T09:00:00Z"
}
```

#### 403 Forbidden

```http
HTTP/1.1 403 Forbidden
Content-Type: application/json

{
  "error": "Forbidden",
  "message": "You don't have permission to access this resource",
  "code": "INSUFFICIENT_PERMISSIONS",
  "requiredPermission": "users:write",
  "userPermissions": ["users:read"]
}
```

#### 404 Not Found

```http
HTTP/1.1 404 Not Found
Content-Type: application/json

{
  "error": "Not Found",
  "message": "User not found",
  "code": "RESOURCE_NOT_FOUND",
  "resourceType": "user",
  "resourceId": 42
}
```

#### 422 Unprocessable Entity

```http
HTTP/1.1 422 Unprocessable Entity
Content-Type: application/json

{
  "error": "Validation Failed",
  "message": "Request validation failed",
  "code": "VALIDATION_ERROR",
  "details": [
    {
      "field": "email",
      "message": "Email already exists",
      "code": "DUPLICATE_EMAIL",
      "value": "john@example.com"
    }
  ]
}
```

#### 429 Too Many Requests

```http
HTTP/1.1 429 Too Many Requests
Retry-After: 3600
X-RateLimit-Limit: 1000
X-RateLimit-Remaining: 0
X-RateLimit-Reset: 1673611200
Content-Type: application/json

{
  "error": "Rate Limit Exceeded",
  "message": "Too many requests",
  "code": "RATE_LIMIT_EXCEEDED",
  "limit": 1000,
  "remaining": 0,
  "resetAt": "2026-01-13T11:00:00Z",
  "retryAfter": 3600
}
```

#### 500 Internal Server Error

```http
HTTP/1.1 500 Internal Server Error
Content-Type: application/json
X-Request-ID: req-error-123

{
  "error": "Internal Server Error",
  "message": "An unexpected error occurred",
  "code": "INTERNAL_ERROR",
  "requestId": "req-error-123",
  "timestamp": "2026-01-13T10:00:00Z"
}
```

#### 503 Service Unavailable

```http
HTTP/1.1 503 Service Unavailable
Retry-After: 600
Content-Type: application/json

{
  "error": "Service Unavailable",
  "message": "System is under maintenance",
  "code": "MAINTENANCE_MODE",
  "estimatedRecovery": "2026-01-13T11:00:00Z",
  "retryAfter": 600
}
```

---

## Complete Request-Response Cycles

### Cycle 1: Successful Resource Creation

```http
# REQUEST
POST /api/v1/users HTTP/1.1
Host: api.example.com
Authorization: Bearer token123
Content-Type: application/json
Accept: application/json
Content-Length: 89

{
  "name": "John Doe",
  "email": "john@example.com",
  "role": "user"
}

# RESPONSE
HTTP/1.1 201 Created
Date: Mon, 13 Jan 2026 10:00:00 GMT
Content-Type: application/json; charset=utf-8
Content-Length: 245
Location: /api/v1/users/42
ETag: "user-v1-abc123"
Cache-Control: private, no-cache
X-Request-ID: req-abc-123

{
  "id": 42,
  "name": "John Doe",
  "email": "john@example.com",
  "role": "user",
  "createdAt": "2026-01-13T10:00:00Z",
  "updatedAt": "2026-01-13T10:00:00Z",
  "links": {
    "self": "/api/v1/users/42",
    "orders": "/api/v1/users/42/orders",
    "profile": "/api/v1/users/42/profile"
  }
}
```

---

### Cycle 2: Conditional Update with Conflict

```http
# REQUEST
PUT /api/v1/documents/42 HTTP/1.1
Host: api.example.com
Authorization: Bearer token123
Content-Type: application/json
If-Match: "doc-v5"
Content-Length: 67

{
  "title": "Updated Document",
  "content": "New content here"
}

# RESPONSE (Conflict - document was updated by someone else)
HTTP/1.1 412 Precondition Failed
Date: Mon, 13 Jan 2026 10:00:00 GMT
Content-Type: application/json; charset=utf-8
ETag: "doc-v7"
X-Request-ID: req-xyz-789

{
  "error": "Precondition Failed",
  "message": "Document was modified by another user",
  "code": "STALE_VERSION",
  "currentVersion": "doc-v7",
  "requestedVersion": "doc-v5",
  "lastModifiedBy": "jane@example.com",
  "lastModifiedAt": "2026-01-13T09:55:00Z",
  "links": {
    "current": "/api/v1/documents/42"
  }
}
```

---

### Cycle 3: Cached Resource Retrieval

```http
# FIRST REQUEST
GET /api/v1/products/123 HTTP/1.1
Host: api.example.com
Accept: application/json

# FIRST RESPONSE (Fresh data)
HTTP/1.1 200 OK
Content-Type: application/json
ETag: "product-v5"
Cache-Control: public, max-age=3600
Last-Modified: Mon, 13 Jan 2026 09:00:00 GMT

{
  "id": 123,
  "name": "Product Name",
  "price": 99.99
}

# SECOND REQUEST (within cache time, with ETag)
GET /api/v1/products/123 HTTP/1.1
Host: api.example.com
If-None-Match: "product-v5"
Accept: application/json

# SECOND RESPONSE (Not modified - use cache)
HTTP/1.1 304 Not Modified
ETag: "product-v5"
Cache-Control: public, max-age=3600
Last-Modified: Mon, 13 Jan 2026 09:00:00 GMT
```

---

### Cycle 4: Rate Limit Exceeded

```http
# REQUEST (101st request in window)
GET /api/v1/products HTTP/1.1
Host: api.example.com
Authorization: Bearer token123

# RESPONSE
HTTP/1.1 429 Too Many Requests
Content-Type: application/json
Retry-After: 60
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 0
X-RateLimit-Reset: 1673611260
X-Request-ID: req-rate-limit-xyz

{
  "error": "Rate Limit Exceeded",
  "message": "You have exceeded the rate limit of 100 requests per minute",
  "code": "RATE_LIMIT_EXCEEDED",
  "limit": 100,
  "window": "1 minute",
  "remaining": 0,
  "resetAt": "2026-01-13T10:01:00Z",
  "retryAfter": 60
}
```

---

## Best Practices

### 1. Always Match Status Code with Body Content

```http
# ✅ Correct - 404 with error details
HTTP/1.1 404 Not Found
{"error": "Not Found", "message": "User not found"}

# ❌ Wrong - 200 with error in body
HTTP/1.1 200 OK
{"error": "Not Found", "message": "User not found"}
```

### 2. Include Helpful Headers

```http
# ✅ Good - Rich context
HTTP/1.1 201 Created
Location: /users/42
ETag: "user-v1"
X-Request-ID: req-abc-123
Content-Type: application/json

{...}

# ❌ Minimal - Harder to debug/cache
HTTP/1.1 201 Created
Content-Type: application/json

{...}
```

### 3. Use Consistent Error Format

```http
# ✅ Consistent structure
{
  "error": "Error Type",
  "message": "Description",
  "code": "MACHINE_CODE",
  "details": [...]
}

# ❌ Inconsistent
{
  "err": "Something went wrong"  // Different shape!
}
```

### 4. Provide Cache Instructions

```http
# ✅ Clear caching rules
HTTP/1.1 200 OK
Cache-Control: public, max-age=3600
ETag: "v5"
Last-Modified: Mon, 13 Jan 2026 09:00:00 GMT

# ❌ No caching guidance
HTTP/1.1 200 OK
```

### 5. Include Request Tracking

```http
# ✅ Trackable
HTTP/1.1 500 Internal Server Error
X-Request-ID: req-error-123

{
  "requestId": "req-error-123",
  ...
}

# ❌ Not trackable
HTTP/1.1 500 Internal Server Error
{"error": "Something broke"}
```

### 6. Use Appropriate Status for No Content

```http
# ✅ 204 when truly no content
DELETE /users/42
→ HTTP/1.1 204 No Content

# ✅ 200 when returning confirmation
DELETE /users/42
→ HTTP/1.1 200 OK
  {"message": "Deleted", "deletedAt": "..."}
```

### 7. Provide Links for Navigation

```http
# ✅ Hypermedia links
HTTP/1.1 200 OK

{
  "id": 42,
  "name": "John",
  "links": {
    "self": "/users/42",
    "orders": "/users/42/orders"
  }
}

# ❌ Client must construct URLs
{
  "id": 42,
  "name": "John"
}
```

---

## Common Mistakes

### Mistake 1: Wrong Status Code

```http
# ❌ Returning 200 for errors
HTTP/1.1 200 OK
{"error": "User not found"}

# ✅ Use proper status
HTTP/1.1 404 Not Found
{"error": "Not Found", "message": "User not found"}
```

### Mistake 2: Inconsistent Error Format

```http
# ❌ Different formats
Response 1: {"error": "Not found"}
Response 2: {"err": "Invalid", "msg": "Bad request"}
Response 3: {"message": "Server error"}

# ✅ Consistent format
All responses:
{
  "error": "Type",
  "message": "Description",
  "code": "MACHINE_CODE"
}
```

### Mistake 3: Missing Content-Type

```http
# ❌ No Content-Type
HTTP/1.1 200 OK

{"data": "..."}

# ✅ Always include
HTTP/1.1 200 OK
Content-Type: application/json

{"data": "..."}
```

### Mistake 4: Not Providing Error Details

```http
# ❌ Vague error
HTTP/1.1 400 Bad Request
{"error": "Bad Request"}

# ✅ Helpful details
HTTP/1.1 400 Bad Request
{
  "error": "Validation Failed",
  "details": [
    {"field": "email", "message": "Invalid format"}
  ]
}
```

### Mistake 5: Ignoring Cache Headers

```http
# ❌ No cache guidance
HTTP/1.1 200 OK
Content-Type: application/json

{...}

# ✅ Explicit cache control
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: private, no-cache  // or max-age=3600
ETag: "v5"

{...}
```

### Mistake 6: Missing Location on 201

```http
# ❌ Created but where?
POST /users
→ HTTP/1.1 201 Created
  {"id": 42, "name": "John"}

# ✅ Location tells where
POST /users
→ HTTP/1.1 201 Created
  Location: /users/42
  {"id": 42, "name": "John"}
```

---

## Summary

### Response Components Work Together

**The Complete Picture:**
```
Response = Status Code + Headers + Body (optional)

Each component has a role:
├─ Status Code: What happened (success/failure/redirect)
├─ Headers: Context, format, caching, metadata
└─ Body: Data or error details (when applicable)

Together they form a complete, self-descriptive answer.
```

### Key Principles

1. **Status code is king** - It determines how client handles response
2. **Headers provide context** - Caching, format, location, rate limits
3. **Body provides details** - Data on success, explanation on failure
4. **Consistency is crucial** - Same patterns across all endpoints
5. **Be explicit** - Don't make clients guess
6. **Include tracking** - X-Request-ID for debugging
7. **Guide the client** - Links, pagination, next steps

### Response Checklist

**Every response should have:**
- ✅ Appropriate status code
- ✅ Content-Type header
- ✅ Cache-Control (when data can be cached)
- ✅ ETag (for version tracking)
- ✅ X-Request-ID (for tracking)
- ✅ Consistent error format (for failures)
- ✅ Location header (for 201 Created)
- ✅ Rate limit headers (when applicable)
- ✅ CORS headers (when needed)

### Status Code Selection Guide

```
2xx Success:
  200 OK - Successful GET, PUT, PATCH (with body)
  201 Created - Successful POST creating resource
  202 Accepted - Async operation started
  204 No Content - Successful DELETE or update without body

3xx Redirection:
  301 Moved Permanently - Resource moved
  304 Not Modified - Cached version still valid
  307 Temporary Redirect - Temporary move

4xx Client Errors:
  400 Bad Request - Invalid request format
  401 Unauthorized - Authentication required/failed
  403 Forbidden - No permission
  404 Not Found - Resource doesn't exist
  409 Conflict - Concurrent modification
  422 Unprocessable Entity - Validation failed
  429 Too Many Requests - Rate limit exceeded

5xx Server Errors:
  500 Internal Server Error - Unexpected server error
  502 Bad Gateway - Upstream server error
  503 Service Unavailable - Server overloaded/maintenance
```

---

## Next Steps

Now that you understand response components, explore:
- Query parameters for filtering and sorting
- Advanced pagination strategies
- HATEOAS for discoverable APIs
- API versioning strategies
- Performance optimization with caching
- Real-world error handling patterns
